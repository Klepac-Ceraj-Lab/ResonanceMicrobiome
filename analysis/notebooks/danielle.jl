samples = ["C0052-5F-1A",
    "C0126-8F-1A",
    "C0126-8F-1B",
    "C0127-6F-1B",
    "C0286-5F-1A",
    "C0296-5F-1A",
    "C0053-6F-1A",
    "C0108-4F-1A",
    "C0498-1F-2A",
    "C0498-1F-1A",
    "C0043-7F-1A",
    "C0117-4F-2A",
    "C0117-4F-1A",
    "C0117-4F-1B",
    "C0499-1F-1A",
    "C0499-1F-1B",
    "C0061-6F-1A",
    "C0061-6F-2A",
    "C0062-6F-1A",
    "C0062-6F-2A",
    "C0067-6F-1A",
    "C0082-4F-1A",
    "C0499-1F-2A",
    "C0505-1F-1A",
    "C0506-1F-2A",
    "C0506-1F-1A",
    "C0507-1F-2A",
    "C0507-1F-1A",
    "C0509-1F-2A",
    "C0509-1F-1B",
    "C0511-1F-1A",
    "C0511-1F-2A",
    "C0511-1F-2B",
    "C0066-6F-1A",
    "C0066-6F-1B",
    "C0066-6F-2A",
    "C0240-3F-2A",
    "C0240-3F-1A",
    "C0476-3F-2A",
    "C0476-3F-1A",
    "C0516-1F-1A",
    "C0516-1F-2A",
    "C0516-1F-2B",
    "C0229-4F-1A",
    "C0229-4F-2A",
    "C0479-3F-1A",
    "C0479-3F-2A",
    "C0520-1F-1A",
    "C0520-1F-2A",
    "C0521-1F-1A",
    "C0521-1F-2A",
    "C0539-1F-1A",
    "C0530-1F-1A",
    "C0530-1F-2A",
    "C0544-1F-2A",
    "C0544-1F-1A",
    "C0552-1F-1A",
    "C0552-1F-2A",
    "C0541-1F-2A",
    "C0541-1F-1A",
    "C0482-3F-1A",
    "C0202-4F-1A",
    "C0202-4F-2A",
    "C0547-1F-1A",
    "C0547-1F-2A",
    "C0119-3F-1A",
    "C0119-3F-2A",
    "C0258-3F-1A",
    "C0258-3F-2A",
    "C0568-1F-1A",
    "C0189-5F-2A",
    "C0189-5F-1A",
    "C0570-1F-1A",
    "C0570-1F-2A",
    "C0188-5F-1A",
    "C0188-5F-2A",
    "C0569-1F-1A",
    "C0569-1F-2A",
    "C0179-4F-2A",
    "C0179-4F-1A",
    "M0652-1F-1A",
    "M0647-1F-1A",
    "M0656-1F-1A",
    "C0660-1E-1A",
    "M0649-1F-1A",
    "C0683-1E-1A",
    "C0686-1E-1A",
    "M0647-2F-1A",
    "M0647-2E-1A",
    "C0107-4E-1A",
    "M0685-1E-1A",
    "C0106-6E-1A",
    "C0673-1E-1A",
    "M0676-1E-1A",
    "C0202-6E-1A",
    "M0652-2F-1A",
    "M0682-1F-1A",
    "M0703-1F-1A",
    "M0682-1E-1A",
    "C0679-1E-1A",
    "M0699-1F-1A",
    "C0688-1E-1A",
    "C0237-4E-1A",
    "M0674-1F-1A",
    "C0694-1E-1A",
    "M0705-1E-1A",
    "M0714-1E-1A",
    "M0662-2E-1A",
    "C0123-3E-1A",
    "C0623-1E-1A",
    "M0680-2E-1A",
    "M0711-1F-1A",
    "M0711-1E-1A",
    "M0715-1E-1A",
    "M0713-1F-1A",
    "M0713-1E-1A",
    "C2014-2E-1A",
    "M0716-1E-1A",
    "M0718-1E-1A",
    "C0730-1E-1A",
    "C0672-1E-1A",
    "C0058-4E-1A",
    "C0059-4E-1A",
    "M0656-2F-1A",
    "M0723-1F-1A",
    "M0723-1E-1A",
    "M0685-2E-1A",
    "C0735-1E-1A",
    "C2002-3E-1A",
    "C0725-1E-1A",
    "M0749-1E-1A",
    "M0754-1F-1A",
    "M0754-1E-1A",
    "M0652-3E-1A",
    "M0652-3F-1A",
    "M0757-1E-1A",
    "M0644-3E-1A",
    "M0753-1E-1A",
    "M0774-1E-1A",
    "M0715-2E-1A",
    "C0767-1E-1A",
    "C0047-7E-1A",
    "M0765-1E-1A",
    "M0662-3E-1A",
    "M0742-2F-1A",
    "M0742-2E-1A",
    "M0713-2F-1A",
    "M0713-2E-1A",
    "C0743-1E-1A",
    "C0724-1E-1A",
    "M0745-2E-1A",
    "M0711-2E-1A",
    "M0711-2F-1A",
    "M0792-1E-1A",
    "M0791-1E-1A",
    "M0656-3F-1A",
    "M0703-2F-1A",
    "C0789-1E-1A",
    "C0788-1E-1A",
    "M0790-1E-1A",
    "M0700-3E-1A",
    "C0784-1E-1A",
    "C0785-1E-1A",
    "M0651-2E-1A",
    "M0752-2E-1A",
    "M0752-2F-1A",
    "C0768-1E-1A",
    "M0801-1E-1A",
    "M0742-2E-2A",
    "M0808-1E-1A",
    "M0774-2E-1A",
    "C0799-1E-1A",
    "M0805-1E-1A",
    "M0699-3F-1A",
    "C0811-1E-1A",
    "C0053-8E-1A",
    "C0332-4E-1A",
    "C0052-7E-1A",
    "M0794-1E-1A",
    "M0824-1E-1A",
    "M0749-2E-1A",
    "M0804-1E-1A",
    "M0770-2E-1A",
    "C0126-9E-1A",
    "M0776-2E-1A",
    "C0127-7E-1A",
    "M0753-2E-1A",
    "C0825-1E-1A",
    "C0286-6E-1A",
    "C0296-6E-1A",
    "C0494-2E-1A",
    "M0713-3F-1A",
    "M0713-3E-1A",
    "M0834-1E-1A",
    "M0828-1E-1A",
    "M0828-1F-1A",
    "C2018-3E-1A",
    "C0469-2E-1A",
    "M0822-1E-1A",
    "C0837-1E-1A",
    "M0703-3F-1A",
    "M0844-1E-1A",
    "M0839-1F-1A",
    "M0744-3F-1A",
    "M0752-3F-1A",
    "M0851-1F-1A",
    "C0723-3F-1A",
    "C0754-2F-1A",
    "M0839-3F-1A",
    "C0925-1F-1A",
    "C0649-2F-1A",
    "C0682-3F-1A",
    "C0656-4F-1A",
    "C0699-4F-1A",
    "C0711-4F-1A",
    "M0973-1F-1A",
    "C0654-2F-1A",
    "M0894-2F-1A",
    "M0890-3F-1A",
    "M0922-2F-1A",
    "M0932-2F-1A",
    "M0934-2F-1A",
    "C0742-3F-1A",
    "M0946-1F-1A",
    "M0989-1F-1A",
    "C0647-4F-1A",
    "M0891-3F-1A",
    "M0937-2F-1A",
    "C0633-2F-1A",
    "M0892-3F-1A",
    "M0919-2F-1A",
    "M0935-2F-1A",
    "M0960-1F-1A",
    "M0996-1F-1A",
    "C0703-4F-1A",
    "M0883-3F-1A",
    "M0913-2F-1A",
    "C0661-2F-1A",
    "M0881-3F-1A",
    "M0998-1F-1A",
    "M0999-1F-1A",
    "C0541-2F-1A",
    "C0739-2F-1A",
    "M1008-1F-1A",
    "C0713-4F-1A",
    "C2014-3F-1A",
    "M0888-3F-1A",
    "M0948-2F-1A",
    "M1007-1F-1A",
    "M0947-2F-1A",
    "M1016-1F-1A",
    "M0886-3F-1A",
    "M0950-2F-1A",
    "C0752-4F-1A",
    "M1027-1F-1A",
    "C1034-1F-1A",
    "C0402-3F-1A",
    "C0451-2F-1A",
    "M0980-2F-1A",
    "M1015-1F-1A",
    "C0192-4F-1A",
    "C0348-3F-1A",
    "C0744-4F-1A",
    "C0754-3F-1A",
    "M0896-3F-1A",
    "C0175-2F-1A",
    "C0674-3F-1A",
    "M0918-3F-1A",
    "M0958-2F-1A",
    "M1028-1F-1A",
    "M0951-2F-1A",
    "M1005-2F-1A",
    "M0961-2F-1A",
    "M1046-1F-1A",
    "C0603-4F-1A",
    "M0946-3F-1A",
    "C0229-5F-1A",
    "C0643-2F-1A",
    "C0499-2F-1A",
    "C0507-2F-1A",
    "M0973-2F-1A",
    "C0550-3F-1A",
    "C1009-1F-1A",
    "M1008-2F-1A",
    "M0977-2F-1A",
    "C0660-2F-1A",
    "M1037-2F-1A",
    "C0656-5F-1A",
    "M0958-3F-1A",
    "M0961-3F-1A",
    "M0996-2F-1A",
    "M1056-1F-1A",
    "M1047-2F-1A",
    "M1065-1F-1A",
    "M1060-1F-1A",
    "C0711-5F-1A",
    "M1015-2F-1A",
    "M1066-1F-1A",
    "M1068-1F-1A",
    "M0984-2F-1A",
    "M1064-1F-1A",
    "M0973-3F-1A",
    "M1079-1F-1A",
    "M1086-1F-1A",
    "C0834-4F-1A",
    "C0692-4F-1A",
    "M1074-1F-1A",
    "C0788-2F-1A",
    "C0789-2F-1A",
    "M1058-1F-1A",
    "M1087-1F-1A",
    "M1095-1F-1A",
    "C0839-4F-1A",
    "C0936-1F-1A",
    "M1057-1F-1A",
    "M1067-1F-1A",
    "M1096-1F-1A",
    "M1099-1F-1A",
    "C2018-4F-1A",
    "M1059-1F-1A",
    "M1078-1F-1A",
    "M1064-2F-1A",
    "M1008-3F-1A",
    "M1022-2F-1A",
    "C1026-1F-1A",
    "C1075-1F-1A",
    "M1083-1F-1A",
    "C1102-1F-1A",
    "C0698-2F-1A",
    "M1061-2F-1A",
    "M1113-1F-1A",
    "C0851-4F-1A",
    "M1056-2F-1A",
    "C1090-1F-1A",
    "M1115-1F-1A",
    "M1116-1F-1A",
    "C0828-4F-1A",
    "C1062-3F-1A",
    "M1082-1F-1A",
    "C0461-4F-1A",
    "M1110-1F-1A",
    "C0388-7F-1A",
    "M1088-1F-1A",
    "C1089-1F-1A",
    "M1109-1F-1A"]

samples = stoolsample.(samples)
genera = sqlprofile(taxdb, tablename="taxa", kind="genus")

genera = view(genera, sites=sampleid.(samples)) |> copy

df = DataFrame(occurrences(genera), Symbol.(sitenames(genera)))
df = hcat(DataFrame(Taxon=speciesnames(genera)), df)
names!(df, map(n-> Symbol(replace(string(n), "_"=>"-")), names(df)))

CSV.write("/home/kevin/Desktop/mgx_genera.csv", df)
